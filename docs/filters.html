<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Filters &#8212; QuartzBio  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=6625fa76" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=039e1c02" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=b3ba4146"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Querying Datasets and Files" href="querying_datasets_and_files.html" />
    <link rel="prev" title="Metadata and Global Beacons" href="metadata_and_global_beacons.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="filters">
<h1>Filters<a class="headerlink" href="#filters" title="Permalink to this heading">¶</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">¶</a></h2>
<p>The EDP provides an easy-to-use, real-time API for <a class="reference external" href="https://quartzbio.freshdesk.com/a/solutions/articles/73000612356">querying datasets and files</a> through the Python and R client libraries, which also enable the application of complex filters on dataset and file fields. Users can also utilize Bash to query and filter datasets.</p>
<p>Users can filter on any field in a dataset or file:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Filter ClinVar dataset to pathogenic variants</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">get_by_full_path</span><span class="p">(</span><span class="s1">&#39;quartzbio:Public:/ClinVar/5.2.0-20210110/Variants-GRCH37&#39;</span><span class="p">)</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">query</span><span class="p">()</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">clinical_significance</span><span class="o">=</span><span class="s1">&#39;pathogenic&#39;</span><span class="p">)</span>

<span class="c1">#Filter ClinVar file to pathogenic variants</span>

<span class="n">clinvar</span> <span class="o">=</span> <span class="n">Object</span><span class="o">.</span><span class="n">get_by_full_path</span><span class="p">(</span><span class="s1">&#39;quartzbio:Public:/ClinVar/5.2.0-20210110/ClinVar-5-2-0-20210110-Variants-GRCH37-1425664822266145048-20221110194518.json.gz&#39;</span><span class="p">)</span>
<span class="n">clinvar</span><span class="o">.</span><span class="n">query</span><span class="p">()</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">clinical_significance</span><span class="o">=</span><span class="s1">&#39;pathogenic&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Filters can be modified using “filter actions”, which let users adjust the condition of a filter. To specify a filter action, users can append it to the field name when building a filter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">field</span><span class="o">&gt;</span><span class="n">__</span><span class="o">&lt;</span><span class="n">action</span><span class="o">&gt;</span>
<span class="c1">#For example, date__gte for filtering by dates greater or equal to the input</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Action</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><em>iexact</em> (default)</p></td>
<td><p>Field is equal to value (case-insensitive). If the field’s value is a list, this will match values within the list, not the list as a whole.</p></td>
</tr>
<tr class="row-odd"><td><p><em>exact</em></p></td>
<td><p>Field is an exact match to value. Useful for case-sensitive string field queries.</p></td>
</tr>
<tr class="row-even"><td><p><em>in</em></p></td>
<td><p>Field is “one of” a list of values. (similar to Python’s <code class="docutils literal notranslate"><span class="pre">in</span></code> operator).</p></td>
</tr>
<tr class="row-odd"><td><p><em>range</em></p></td>
<td><p>Field is a number within two values. Ranges are inclusive (fully closed).</p></td>
</tr>
<tr class="row-even"><td><p><em>gt</em></p></td>
<td><p>Field is a number greater than value.</p></td>
</tr>
<tr class="row-odd"><td><p><em>lt</em></p></td>
<td><p>Field is a number less than value.</p></td>
</tr>
<tr class="row-even"><td><p><em>gte</em></p></td>
<td><p>Field is a number greater than or equal to value.</p></td>
</tr>
<tr class="row-odd"><td><p><em>lte</em></p></td>
<td><p>Field is a number less than or equal to value.</p></td>
</tr>
<tr class="row-even"><td><p><em>contains</em></p></td>
<td><p>Field contains this string value.</p></td>
</tr>
<tr class="row-odd"><td><p><em>regexp</em></p></td>
<td><p>Field value matches this regular expression. (<strong>Note: The action is only compatible with datasets</strong>)</p></td>
</tr>
</tbody>
</table>
<p>Some filter actions (<code class="docutils literal notranslate"><span class="pre">range</span></code>, <code class="docutils literal notranslate"><span class="pre">gt</span></code>, <code class="docutils literal notranslate"><span class="pre">lt</span></code>, <code class="docutils literal notranslate"><span class="pre">gte</span></code>, <code class="docutils literal notranslate"><span class="pre">lte</span></code>) may only be used on numeric and date fields.</p>
<p>Full-text fields use the <code class="docutils literal notranslate"><span class="pre">contains</span></code> filter action by default and act like a typical search would. Results are ordered by relevance based on the provided search terms. When using the <code class="docutils literal notranslate"><span class="pre">contains</span></code> action on string fields, the system converts the filter into a regular expression: <code class="docutils literal notranslate"><span class="pre">.*{VALUE}.*</span></code>, which is equivalent to the SQL expressions %{VALUE}%.</p>
</section>
<section id="string-filters">
<h2>String Filters<a class="headerlink" href="#string-filters" title="Permalink to this heading">¶</a></h2>
<p>Users may filter string fields using the exact (or case-insensitive) match, regular expression match (<code class="docutils literal notranslate"><span class="pre">regexp</span></code>), or prefix match (<code class="docutils literal notranslate"><span class="pre">prefix</span></code>). Users can also match against multiple strings at once (a boolean <em>or</em>) using the “<code class="docutils literal notranslate"><span class="pre">in&quot;</span></code> filter. By default, filters on string fields use the “equals” match.</p>
<p>In Python:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Query Dataset</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">quartzbio</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">get_by_full_path</span><span class="p">(</span><span class="s1">&#39;quartzbio:Public:/ClinVar/5.2.0-20210110/Variants-GRCH37&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">()</span>

<span class="c1"># Equals match</span>
<span class="n">q</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">gene</span><span class="o">=</span><span class="s1">&#39;BRCA1&#39;</span><span class="p">)</span>

<span class="c1"># Equals match (in list)</span>
<span class="n">q</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">gene__in</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;BRCA1&#39;</span><span class="p">,</span> <span class="s1">&#39;BRCA2&#39;</span><span class="p">])</span>

<span class="c1"># Regular expression match</span>
<span class="n">q</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">gene__regexp</span><span class="o">=</span><span class="s1">&#39;BRCA[12]&#39;</span><span class="p">)</span>

<span class="c1"># Prefix match</span>
<span class="n">q</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">gene__prefix</span><span class="o">=</span><span class="s1">&#39;BRCA&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="text-filters">
<h2>Text Filters<a class="headerlink" href="#text-filters" title="Permalink to this heading">¶</a></h2>
<p>Long (paragraph-length) fields typically use the <code class="docutils literal notranslate"><span class="pre">text</span></code> data type. The “<code class="docutils literal notranslate"><span class="pre">contains&quot;</span></code> filter in text fields works more like a search than a filter. Results that match the search term are brought back in the order of relevance.</p>
<p>In Python:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">get_by_full_path</span><span class="p">(</span><span class="s1">&#39;quartzbio:Public:/MEDLINE/2.3.4-2018/MEDLINE-sample&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">()</span>

<span class="c1"># Contains match for text fields</span>
<span class="n">q</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">abstract__contains</span><span class="o">=</span><span class="s1">&#39;diabetes&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="numeric-date-filters">
<h2>Numeric &amp; Date Filters<a class="headerlink" href="#numeric-date-filters" title="Permalink to this heading">¶</a></h2>
<p>Numeric and date fields can be filtered by exact match, exact match in a list (<code class="docutils literal notranslate"><span class="pre">in</span></code>), half-open range match (<code class="docutils literal notranslate"><span class="pre">range</span></code>), and standard operators (<code class="docutils literal notranslate"><span class="pre">gt</span></code>, <code class="docutils literal notranslate"><span class="pre">lt</span></code>, <code class="docutils literal notranslate"><span class="pre">gte</span></code>, <code class="docutils literal notranslate"><span class="pre">lte</span></code>). Dates are in the format <code class="docutils literal notranslate"><span class="pre">YYYY-MM-DD</span></code>.</p>
<p>In Python:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">get_by_full_path</span><span class="p">(</span><span class="s1">&#39;quartzbio:Public:/ClinVar/5.2.0-20210110/Variants-GRCH37&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">()</span>

<span class="c1"># Equals match</span>
<span class="n">q</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">ORIGIN</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># Equals match (in list)</span>
<span class="n">q</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">ORIGIN__in</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="c1"># Range query</span>
<span class="n">q</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">ORIGIN__range</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="c1"># Operator query (gt/gte/lt/lte)</span>
<span class="n">q</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">ORIGIN__gt</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="entity-filters">
<h2>Entity Filters<a class="headerlink" href="#entity-filters" title="Permalink to this heading">¶</a></h2>
<p>EDP-supported <a class="reference external" href="https://quartzbio.freshdesk.com/en/support/solutions/articles/73000603092">Entities</a> can be used for filtering, without requiring the exact field name that the Entity resides in. The entity filters are only compatible with datasets.</p>
<p>In Python:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">clinvar</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">get_by_full_path</span><span class="p">(</span><span class="s1">&#39;quartzbio:Public:/ClinVar/5.2.0-20210110/Variants-GRCH37&#39;&#39;)</span>

<span class="c1"># Gene entity query</span>
<span class="n">clinvar</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">entities</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;gene&#39;</span><span class="p">,</span> <span class="s1">&#39;BRCA2&#39;</span><span class="p">]])</span>

<span class="c1"># Variant entity query</span>
<span class="n">clinvar</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">entities</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;variant&#39;</span><span class="p">,</span> <span class="s1">&#39;GRCH37-13-32890599-32890599-C&#39;</span><span class="p">]])</span>
</pre></div>
</div>
</section>
<section id="genomic-coordinate-filters">
<h2>Genomic Coordinate Filters<a class="headerlink" href="#genomic-coordinate-filters" title="Permalink to this heading">¶</a></h2>
<p>A dataset’s genomic build is indicated by the suffix of the dataset’s full_path. The genomic coordinate filters are only compatible with datasets.</p>
<p>In Python:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># GRCh37</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">get_by_full_path</span><span class="p">(</span><span class="s1">&#39;quartzbio:Public:/ClinVar/5.2.0-20210110/Variants-GRCH37&#39;&#39;).query()</span>

<span class="c1"># GRCh38</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">get_by_full_path</span><span class="p">(</span><span class="s1">&#39;quartzbio:Public:/ClinVar/5.2.0-20210110/Variants-GRCH38&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">()</span>

<span class="c1"># Position (all overlapping features) - these two queries are equivalent</span>
<span class="n">q</span><span class="o">.</span><span class="n">position</span><span class="p">(</span><span class="s1">&#39;chr11&#39;</span><span class="p">,</span> <span class="mi">18313400</span><span class="p">)</span>
<span class="n">q</span><span class="o">.</span><span class="n">position</span><span class="p">(</span><span class="n">chromosome</span><span class="o">=</span><span class="s1">&#39;11&#39;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="mi">18313400</span><span class="p">)</span>

<span class="c1"># Exact position only</span>
<span class="n">q</span><span class="o">.</span><span class="n">position</span><span class="p">(</span><span class="n">chromosome</span><span class="o">=</span><span class="s1">&#39;11&#39;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="mi">17552955</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Range (all overlapping features) - these two queries are equivalent</span>
<span class="n">q</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s1">&#39;chr11&#39;</span><span class="p">,</span> <span class="mi">18313300</span><span class="p">,</span> <span class="mi">18315000</span><span class="p">)</span>
<span class="n">q</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="n">chromosome</span><span class="o">=</span><span class="s1">&#39;11&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">18313300</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">18315000</span><span class="p">)</span>

<span class="c1"># Exact range only</span>
<span class="n">q</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="n">chromosome</span><span class="o">=</span><span class="s1">&#39;11&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">18313399</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">18313403</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="combining-filters">
<h2>Combining Filters<a class="headerlink" href="#combining-filters" title="Permalink to this heading">¶</a></h2>
<p>The examples below show how to filter a dataset on one or two fields. In many cases, users will probably need to combine many filters into a single query.</p>
<p>When manually writing queries in JSON, users can combine and nest filters using boolean operators (‘and’, ‘or’, ‘not’). In the Python client, users can combine filters using the <code class="docutils literal notranslate"><span class="pre">Filter</span></code> and <code class="docutils literal notranslate"><span class="pre">GenomicFilter</span></code> classes (”<code class="docutils literal notranslate"><span class="pre">&amp;</span></code>” for “and”, “<code class="docutils literal notranslate"><span class="pre">|</span></code>” for “or”, and “<code class="docutils literal notranslate"><span class="pre">~</span></code>” for “not”).</p>
<p>In Python:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">get_by_full_path</span><span class="p">(</span><span class="s1">&#39;quartzbio:Public:/ClinVar/5.2.0-20210110/Variants-GRCH37&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">()</span>

<span class="c1"># AND</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">quartzbio</span><span class="o">.</span><span class="n">Filter</span><span class="p">(</span><span class="n">gene</span><span class="o">=</span><span class="s1">&#39;BRCA1&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">quartzbio</span><span class="o">.</span><span class="n">Filter</span><span class="p">(</span><span class="n">clinical_significance</span><span class="o">=</span><span class="s1">&#39;pathogenic&#39;</span><span class="p">)</span>
<span class="n">q</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="c1"># OR</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">quartzbio</span><span class="o">.</span><span class="n">Filter</span><span class="p">(</span><span class="n">gene</span><span class="o">=</span><span class="s1">&#39;BRCA1&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="n">quartzbio</span><span class="o">.</span><span class="n">Filter</span><span class="p">(</span><span class="n">gene</span><span class="o">=</span><span class="s1">&#39;BRCA2&#39;</span><span class="p">)</span>
<span class="n">q</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="c1"># NOT</span>
<span class="n">f</span> <span class="o">=</span> <span class="o">~</span> <span class="n">quartzbio</span><span class="o">.</span><span class="n">Filter</span><span class="p">(</span><span class="n">gene</span><span class="o">=</span><span class="s1">&#39;BRCA1&#39;</span><span class="p">)</span>
<span class="n">q</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="query-strings">
<h2>Query Strings<a class="headerlink" href="#query-strings" title="Permalink to this heading">¶</a></h2>
<p>Query strings are parsed into a series of terms and operators. A query string can be provided as part of an EDP dataset query in combination with filters, or as an alternative to filters.  The query strings are only compatible with datasets.</p>
<p>Terms in a query string can be single words - “quick” or “brown” - or a phrase surrounded by double quotes - “quick brown” - which will search for all the words in the phrase, in the same order. The query syntax is based on the <a class="reference external" href="https://lucene.apache.org/core/2_9_4/queryparsersyntax.html">Lucene query syntax</a>.</p>
<p>Queries are useful to find records that best match a word or phrase, relative to others. Filters are designed to reduce the potential result set by asking yes/no questions on every record in a dataset.</p>
<p>Query string operators allow users to customize a search. The available options are explained below:</p>
<section id="field-names">
<h3>Field Names<a class="headerlink" href="#field-names" title="Permalink to this heading">¶</a></h3>
<p>By default, when no field names are specified, all string or text fields are searched for each term. Users can provide an explicit field name if they know the field in question:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">status</span><span class="p">:</span><span class="n">active</span>
</pre></div>
</div>
<p>Users can do an exact match on a specific field, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gene</span><span class="p">:</span><span class="s2">&quot;BRCA1&quot;</span>
</pre></div>
</div>
<p>To search for one-or-more terms in a field, users can combine them with <code class="docutils literal notranslate"><span class="pre">OR</span></code> (default) or <code class="docutils literal notranslate"><span class="pre">AND</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gene</span><span class="p">:(</span><span class="n">TTN</span><span class="p">)</span>
<span class="n">gene</span><span class="p">:(</span><span class="n">TTN</span> <span class="n">OR</span> <span class="n">BRCA1</span><span class="p">)</span>
<span class="n">gene_family</span><span class="p">:(</span><span class="n">Olfactory</span> <span class="n">AND</span> <span class="n">receptors</span><span class="p">)</span>
</pre></div>
</div>
<p>Users can also find records with missing fields:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">_missing_</span><span class="p">:</span><span class="n">sample_id</span>
</pre></div>
</div>
<p>Or, records where the field has a value (i.e. “not missing”):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">_exists_</span><span class="p">:</span><span class="n">sample_id</span>
</pre></div>
</div>
</section>
<section id="wildcards">
<h3>Wildcards<a class="headerlink" href="#wildcards" title="Permalink to this heading">¶</a></h3>
<p>Wildcard searches can be run on individual terms, using <code class="docutils literal notranslate"><span class="pre">?</span></code> to replace a single character, and <code class="docutils literal notranslate"><span class="pre">*</span></code> to replace zero or more characters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">BRCA</span><span class="o">*</span>
</pre></div>
</div>
</section>
<section id="ranges">
<h3>Ranges<a class="headerlink" href="#ranges" title="Permalink to this heading">¶</a></h3>
<p>Ranges can be specified for almost any field data type. They are most useful for dates and numeric fields. Inclusive ranges are specified with square brackets <code class="docutils literal notranslate"><span class="pre">[min</span> <span class="pre">TO</span> <span class="pre">max]</span></code> and exclusive ranges with curly brackets <code class="docutils literal notranslate"><span class="pre">{min</span> <span class="pre">TO</span> <span class="pre">max}</span></code>.</p>
<p>For example, this query will retrieve records for all days in 2012:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">date</span><span class="p">:[</span><span class="mi">2012</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="n">TO</span> <span class="mi">2012</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="p">]</span>
</pre></div>
</div>
<p>Similarly, users can also use ranges on numeric fields:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">count</span><span class="p">:[</span><span class="mi">1</span> <span class="n">TO</span> <span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
<p>And use infinite ranges:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">count</span><span class="p">:[</span><span class="mi">10</span> <span class="n">TO</span> <span class="o">*</span><span class="p">]</span>
</pre></div>
</div>
<p>Standard numeric comparison operators can also be used:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">age</span><span class="p">:</span><span class="o">&gt;</span><span class="mi">10</span> <span class="n">age</span><span class="p">:</span><span class="o">&gt;=</span><span class="mi">10</span> <span class="n">age</span><span class="p">:</span><span class="o">&lt;</span><span class="mi">10</span> <span class="n">age</span><span class="p">:</span><span class="o">&lt;=</span><span class="mi">10</span>
</pre></div>
</div>
<p>To combine an upper and lower bound with the simplified syntax, users can join two clauses with an <code class="docutils literal notranslate"><span class="pre">AND</span></code> operator:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">age</span><span class="p">:(</span><span class="o">&gt;=</span><span class="mi">10</span> <span class="n">AND</span> <span class="o">&lt;</span><span class="mi">20</span><span class="p">)</span> <span class="n">age</span><span class="p">:(</span><span class="o">+&gt;=</span><span class="mi">10</span> <span class="o">+&lt;</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
<p>As processing ranges from a query string is much slower and less reliable than using an explicit range filter, users should try range filters first.</p>
</section>
<section id="grouping">
<h3>Grouping<a class="headerlink" href="#grouping" title="Permalink to this heading">¶</a></h3>
<p>Multiple terms or clauses can be grouped together with parentheses to form sub-queries:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">Serine</span> <span class="n">OR</span> <span class="n">Cysteine</span><span class="p">)</span> <span class="n">AND</span> <span class="n">protease</span>
</pre></div>
</div>
<p>Groups can be used to target a particular field, or to <a class="reference external" href="https://lucene.apache.org/core/2_9_4/queryparsersyntax.html#Boosting%20a%20Term">boost</a> the result of a sub-query:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">status</span><span class="p">:(</span><span class="n">active</span> <span class="n">OR</span> <span class="n">pending</span><span class="p">)</span> <span class="n">title</span><span class="p">:(</span><span class="n">full</span> <span class="n">text</span> <span class="n">search</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
</pre></div>
</div>
</section>
<section id="reserved-characters">
<h3>Reserved characters<a class="headerlink" href="#reserved-characters" title="Permalink to this heading">¶</a></h3>
<p>The following characters are reserved in query strings and must be escaped with a leading backslash when used as part of a query term:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>+ - = &amp;&amp; || &gt; &lt; ! ( ) { } [ ] ^ &quot; ~ * ? : \ /
</pre></div>
</div>
<p>For example, to search for the string <code class="docutils literal notranslate"><span class="pre">(1+1)=2</span></code>, the query should be written as <code class="docutils literal notranslate"><span class="pre">\(1\+1\)\=2</span></code>.</p>
</section>
</section>
<section id="advanced-filters">
<h2>Advanced Filters<a class="headerlink" href="#advanced-filters" title="Permalink to this heading">¶</a></h2>
<p>Users can also compose filters in JSON and apply these filters via R, Python, or the EDP UI:</p>
<p>In Python:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">get_by_full_path</span><span class="p">(</span><span class="s1">&#39;quartzbio:Public:/MEDLINE/2.3.4-2018/MEDLINE-sample&#39;</span><span class="p">)</span>

<span class="c1"># Include all abstracts with &quot;diabetes&quot;</span>
<span class="n">filters</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;abstract__contains&quot;</span><span class="p">,</span> <span class="s2">&quot;diabetes&quot;</span><span class="p">]</span>
<span class="p">]</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">)</span>

<span class="c1"># Exclude all abstracts with &quot;diabetes&quot;</span>
<span class="n">filters</span> <span class="o">=</span> <span class="p">[{</span>
    <span class="s2">&quot;not&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;abstract__contains&quot;</span><span class="p">,</span> <span class="s2">&quot;diabetes&quot;</span><span class="p">]</span>
<span class="p">}]</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">)</span>

<span class="c1"># Find abstracts without &quot;diabetes&quot; from 1977</span>
<span class="n">filters</span> <span class="o">=</span> <span class="p">[{</span>
    <span class="s2">&quot;and&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;not&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;abstract__contains&quot;</span><span class="p">,</span> <span class="s2">&quot;diabetes&quot;</span><span class="p">]},</span>
        <span class="p">{</span>
            <span class="s2">&quot;or&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">[</span><span class="s2">&quot;date_published__regex&quot;</span><span class="p">,</span> <span class="s2">&quot;*1977*&quot;</span><span class="p">],</span>
                <span class="p">[</span><span class="s2">&quot;date_created__range&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;1977-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;1977-12-31&quot;</span><span class="p">]]</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}]</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">)</span>
</pre></div>
</div>
<p>The advanced filter syntax is composed of the following elements:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">{OPERATOR}</span></code> is one of <code class="docutils literal notranslate"><span class="pre">AND</span></code>, <code class="docutils literal notranslate"><span class="pre">OR</span></code>, or <code class="docutils literal notranslate"><span class="pre">NOT</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{FIELD}</span></code> is a documented field name in the dataset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{ACTION}</span></code> is a valid field action in the format <code class="docutils literal notranslate"><span class="pre">{FIELD}__{ACTION}</span></code> (see below).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{VALUE}</span></code> can be a string, numeric, or list value.</p></li>
</ul>
<p>By default, a <code class="docutils literal notranslate"><span class="pre">{FIELD}</span></code> with no attached <code class="docutils literal notranslate"><span class="pre">{ACTION}</span></code> implies the “case-insensitive equals” (<code class="docutils literal notranslate"><span class="pre">iexact</span></code>) operator. Full-text (<code class="docutils literal notranslate"><span class="pre">text</span></code> data type) fields automatically use the “<code class="docutils literal notranslate"><span class="pre">contains&quot;</span></code> filter action instead.</p>
<p>String and text actions include:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Action</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><em>iexact</em></p></td>
<td><p>(default for string/text) Field is equal to value (case-insensitive). If the field’s value is a list, matches a value within the list, not the list as a whole.</p></td>
</tr>
<tr class="row-odd"><td><p><em>exact</em></p></td>
<td><p>Field is an exact match to value. Useful for longer string and text fields.</p></td>
</tr>
<tr class="row-even"><td><p><em>in</em></p></td>
<td><p>Field is “one of” a list of values.</p></td>
</tr>
<tr class="row-odd"><td><p><em>contains</em></p></td>
<td><p>Field contains this string value.</p></td>
</tr>
<tr class="row-even"><td><p><em>regexp</em></p></td>
<td><p>Field value matches this regular expression. (<strong>Note: The action is only compatible with datasets</strong>)</p></td>
</tr>
</tbody>
</table>
<p>Numeric and date field actions include:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Action</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><em>exact</em></p></td>
<td><p>(default for numeric/date) Field is an exact match to value.</p></td>
</tr>
<tr class="row-odd"><td><p><em>range</em></p></td>
<td><p>Field is a number within two values (inclusive/fully-closed).</p></td>
</tr>
<tr class="row-even"><td><p><em>gt</em></p></td>
<td><p>Field is a number greater than value.</p></td>
</tr>
<tr class="row-odd"><td><p><em>lt</em></p></td>
<td><p>Field is a number less than value.</p></td>
</tr>
<tr class="row-even"><td><p><em>gte</em></p></td>
<td><p>Field is a number greater than or equal to value.</p></td>
</tr>
<tr class="row-odd"><td><p><em>lte</em></p></td>
<td><p>Field is a number less than or equal to value.</p></td>
</tr>
</tbody>
</table>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">QuartzBio</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Authentication</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="authentication.html">Authentication</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Vaults and Files</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="exporting_data_via_api.html">Exporting Data via API</a></li>
<li class="toctree-l1"><a class="reference internal" href="import_parameters.html">Import Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="import_parameters.html#json-jsonl">JSON (JSONL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="importing_data_via_api.html">Importing Data via API</a></li>
<li class="toctree-l1"><a class="reference internal" href="vaults_and_objects.html">Vaults and Objects</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Datasets</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="creating_and_migrating_datasets.html">Creating and Migrating Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataset_templates.html">Dataset Templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataset_versioning_via_api.html">Dataset Versioning via API</a></li>
<li class="toctree-l1"><a class="reference internal" href="joining_and_aggregating_datasets.html">Joining and Aggregating Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="transforming_datasets.html">Transforming Datasets</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Expressions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="expression_functions.html">Expression Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="expressions.html">Expressions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Global Search</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="data_discovery_via.html">Data Discoverty via API</a></li>
<li class="toctree-l1"><a class="reference internal" href="metadata_and_global_beacons.html">Metadata and Global Beacons</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Queries and Filters</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Filters</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#string-filters">String Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#text-filters">Text Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#numeric-date-filters">Numeric &amp; Date Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#entity-filters">Entity Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#genomic-coordinate-filters">Genomic Coordinate Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#combining-filters">Combining Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#query-strings">Query Strings</a></li>
<li class="toctree-l2"><a class="reference internal" href="#advanced-filters">Advanced Filters</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="querying_datasets_and_files.html">Querying Datasets and Files</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="quartzbio.annotate.html">quartzbio.annotate module</a></li>
<li class="toctree-l1"><a class="reference internal" href="quartzbio.client.html">quartzbio.client module</a></li>
<li class="toctree-l1"><a class="reference internal" href="quartzbio.errors.html">quartzbio.errors module</a></li>
<li class="toctree-l1"><a class="reference internal" href="quartzbio.global_search.html">quartzbio.global_search module</a></li>
<li class="toctree-l1"><a class="reference internal" href="quartzbio.query.html">quartzbio.query module</a></li>
<li class="toctree-l1"><a class="reference internal" href="quartzbio.resource.html">quartzbio.resource package</a></li>
<li class="toctree-l1"><a class="reference internal" href="quartzbio.utils.html">quartzbio.utils package</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="metadata_and_global_beacons.html" title="previous chapter">Metadata and Global Beacons</a></li>
      <li>Next: <a href="querying_datasets_and_files.html" title="next chapter">Querying Datasets and Files</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2025 Precision for Medicine, inc..
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/filters.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>