<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Dataset Templates &#8212; QuartzBio  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=12dfc556" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=b3ba4146"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Dataset Versioning" href="dataset_versioning.html" />
    <link rel="prev" title="Creating and Migrating Datasets" href="creating_and_migrating_datasets.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="dataset-templates">
<h1>Dataset Templates<a class="headerlink" href="#dataset-templates" title="Permalink to this heading">¶</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">¶</a></h2>
<p>Dataset templates describe how data should be transformed. <strong>A template</strong> is a collection of fields (columns) that describe the desired format of some input data. Templates are used to import files, export, query or migrate data. They allow for field normalization and transformation, and also for the addition of fields and annotations. In this article, users will learn how to view, create, update and apply templates for transforming datasets.</p>
</section>
<section id="retrieving-templates">
<h2>Retrieving Templates<a class="headerlink" href="#retrieving-templates" title="Permalink to this heading">¶</a></h2>
<p>To list all templates:</p>
<p>In Python:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">template</span> <span class="ow">in</span> <span class="n">DatasetTemplate</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">template_type</span><span class="o">=</span><span class="s2">&quot;dataset&quot;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">template</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">template</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span> <span class="n">template</span><span class="p">[</span><span class="s1">&#39;account&#39;</span><span class="p">],</span> <span class="n">template</span><span class="p">[</span><span class="s1">&#39;is_public&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>It will return all available dataset templates with their names, template id, organization, account id and status.</p>
<p>To retrieve a template by known ID:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">=</span> <span class="n">quartzbio</span><span class="o">.</span><span class="n">DatasetTemplate</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s1">&#39;template_id&#39;</span><span class="p">)</span><span class="nb">print</span><span class="p">(</span><span class="n">template</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="template-fields">
<h2>Template Fields<a class="headerlink" href="#template-fields" title="Permalink to this heading">¶</a></h2>
<p>The list of fields is the most important part of a template. Each field describes a DatasetField, an object that defines properties of the field such as name, title, and data type as key-value pairs. Fields are written as dictionaries in Python and as lists in R.</p>
<p>Example:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">fields</span> <span class="o">=</span> <span class="p">[{</span>    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;reason&quot;</span><span class="p">,</span>    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Reason&quot;</span>    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The reasons for the significance value&quot;</span><span class="p">,</span>    <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>    <span class="s2">&quot;depends_on&quot;</span><span class="p">:</span> <span class="p">[</span>        <span class="s2">&quot;reason_list&quot;</span>    <span class="p">],</span>    <span class="s2">&quot;expression&quot;</span><span class="p">:</span> <span class="s2">&quot;&#39;, &#39;.join(record.reason_list) if record.reason_list else None&quot;</span><span class="p">,</span>    <span class="s2">&quot;ordering&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,}{</span><span class="o">...</span><span class="p">}]</span>
</pre></div>
</div>
</section>
<section id="template-permissions">
<h2>Template Permissions<a class="headerlink" href="#template-permissions" title="Permalink to this heading">¶</a></h2>
<p>By default, all newly created templates are accessible by everyone at the user’s organization.</p>
<p>If users want the template to be shown in the UI (in the modal used for transforming files), then they can add the import tag to the template.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">=</span> <span class="n">DatasetTemplate</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s1">&#39;id of your template&#39;</span><span class="p">)</span><span class="n">template</span><span class="o">.</span><span class="n">tags</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;import&#39;</span><span class="p">]</span><span class="n">template</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
<p>If users would like to make the template private (accessible only to your user), then they can set the <code class="docutils literal notranslate"><span class="pre">account_id</span></code> parameter to None.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">=</span> <span class="n">DatasetTemplate</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s1">&#39;id of your template&#39;</span><span class="p">)</span>
<span class="n">template</span><span class="o">.</span><span class="n">account_id</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">template</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
<p>If users would like to make the template accessible to all users on EDP (including those outside of your organization) then they can set the <code class="docutils literal notranslate"><span class="pre">is_public</span></code> parameter to True. As always, users should not share anything sensitive outside of their organization.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">=</span> <span class="n">DatasetTemplate</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s1">&#39;id of your template&#39;</span><span class="p">)</span>
<span class="n">template</span><span class="o">.</span><span class="n">is_public</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">template</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="create-a-template">
<h2>Create a Template<a class="headerlink" href="#create-a-template" title="Permalink to this heading">¶</a></h2>
<p>To create a template, users should prepare the list of DatasetFields with information about data types, expressions, entities, etc.</p>
<p>Example of list of fields:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">fields</span> <span class="o">=</span> <span class="p">[{</span>    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;sample&#39;</span><span class="p">,</span>    <span class="s2">&quot;depends_on&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;subject&#39;</span><span class="p">],</span>    <span class="s2">&quot;entity_type&quot;</span><span class="p">:</span> <span class="s2">&quot;sample&quot;</span><span class="p">,</span>    <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Sample ID from SUBJECT&#39;</span><span class="p">,</span>    <span class="s1">&#39;data_type&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span>    <span class="s1">&#39;ordering&#39;</span><span class="p">:</span> <span class="mi">1</span> <span class="p">,</span>    <span class="s1">&#39;expression&#39;</span><span class="p">:</span> <span class="s2">&quot;record.subject&quot;</span><span class="p">},{</span>    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;study&#39;</span><span class="p">,</span>    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;STUDY&#39;</span><span class="p">,</span>    <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Study Code&#39;</span><span class="p">,</span>    <span class="s1">&#39;ordering&#39;</span><span class="p">:</span> <span class="mi">2</span> <span class="p">,</span>    <span class="s1">&#39;expression&#39;</span><span class="p">:</span> <span class="s2">&quot;None if value == &#39;UNASSIGNED&#39; else value&quot;</span><span class="p">,</span>    <span class="s1">&#39;data_type&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">},{</span>    <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>    <span class="s2">&quot;depends_on&quot;</span><span class="p">:</span> <span class="p">[</span>        <span class="s2">&quot;hgvs_c&quot;</span>    <span class="p">],</span>    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;EDP variant entity, computed from the short variant CDS change&quot;</span><span class="p">,</span>    <span class="s2">&quot;expression&quot;</span><span class="p">:</span> <span class="s2">&quot;entity_ids(&#39;variant&#39;, record.hgvs_c) if record.hgvs_c else None&quot;</span><span class="p">,</span>    <span class="s2">&quot;is_transient&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;variant_cdna_grch38&quot;</span><span class="p">}]</span>
</pre></div>
</div>
<p>The following attributes should be added:</p>
<ul class="simple">
<li><p>name - the name of the field</p></li>
<li><p>data_type - the data type of the field</p></li>
<li><p>entity_type – the entity type (only necessary for entity querying)</p></li>
</ul>
<p>The following attributes are optional, but responsible for much of the data transformation:</p>
<ul class="simple">
<li><p>expression - The expression that will be evaluated to populate this field’s value. Put “value” to use the current value. Users can refer to the <a class="reference external" href="https://quartzbio.github.io/quartzbio-python/expressions.html#overview">Expressions documentation</a> for more information. In order to use data from another field (for comparison, splits, etc), users should make sure that they also add it to the list of fields, which will allow them to retrieve it using expression context variables: <code class="docutils literal notranslate"><span class="pre">record.name_of_field</span></code>. Users should also add the field in the depends_on parameter.</p></li>
<li><p>depends_on - This is a list of fields that the expression depends on. Users can add any field names here. This will ensure that those fields expressions are evaluated before its dependents. The template creation will fail if there is a circular dependency.</p></li>
<li><p>is_transient - A transient field is a field that is not indexed into the dataset, but calculated only while the template annotation is running. This is useful for temporary fields/variables for complex templates (default is False)</p></li>
</ul>
<p>The following attributes are optional, and informational only, but encouraged:</p>
<ul class="simple">
<li><p>title - The field’s display name, shown in the UI and in CSV/Excel exports.</p></li>
<li><p>description - Describes the contents of the field, shown in the UI.</p></li>
<li><p>ordering - The order in which this column appears when retrieving data from the dataset. Order is 0-based. Default is 0</p></li>
<li><p>is_hidden - Set to True if the field should be excluded by default from the UI.</p></li>
</ul>
<p>After the list of the fields is prepared, other information about a template can be added:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">=</span> <span class="p">{</span>    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;My Variant Template&quot;</span><span class="p">,</span>    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s1">&#39;1.2.0&#39;</span><span class="p">,</span>    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s1">&#39;Import a special CSV file. Genome is assumed to be GRCh38, also has variant entity for GRCh37.&#39;</span><span class="p">,</span>    <span class="s2">&quot;template_type&quot;</span><span class="p">:</span> <span class="s2">&quot;dataset&quot;</span><span class="p">,</span>    <span class="s2">&quot;is_public&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>    <span class="s2">&quot;entity_params&quot;</span><span class="p">:</span> <span class="p">{</span>        <span class="s1">&#39;disable&#39;</span><span class="p">:</span> <span class="kc">True</span>    <span class="p">},</span>    <span class="s2">&quot;fields&quot;</span><span class="p">:</span> <span class="n">fields</span><span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">template_type</span></code> should be set to “dataset”.</p>
<p>After that, users can create the template:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">quartzbio</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">DatasetTemplate</span>

<span class="n">template</span> <span class="o">=</span> <span class="n">DatasetTemplate</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="o">**</span><span class="n">template</span><span class="p">)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">get_or_create_by_full_path</span><span class="p">(</span><span class="s1">&#39;your dataset path&#39;</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="n">template</span><span class="o">.</span><span class="n">fields</span><span class="p">)</span>
<span class="c1"># Dataset will now have the non-transient fields from the template</span>
<span class="c1"># with desired titles/descriptions and expressions print(dataset.fields())</span>
<span class="c1"># But no records print(dataset.documents_count)</span>
</pre></div>
</div>
<p>Printing the template object will show the template’s ID and contents.</p>
</section>
<section id="create-a-dataset-with-a-template">
<h2>Create a Dataset with a Template<a class="headerlink" href="#create-a-dataset-with-a-template" title="Permalink to this heading">¶</a></h2>
<p>Users can create a dataset and set the structure with a template.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">quartzbio</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">DatasetTemplate</span>

<span class="n">template</span> <span class="o">=</span> <span class="n">DatasetTemplate</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s1">&#39;id of your template&#39;</span><span class="p">)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">get_or_create_by_full_path</span><span class="p">(</span><span class="s1">&#39;your dataset path&#39;</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="n">template</span><span class="o">.</span><span class="n">fields</span><span class="p">)</span>
<span class="c1"># Dataset will now have the non-transient fields from the template</span>
<span class="c1"># with desired titles/descriptions and expressions print(dataset.fields())</span>
<span class="c1"># But no records print(dataset.documents_count)</span>
</pre></div>
</div>
<p>Users can also create and a dataset and add the fields during file import:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">quartzbio</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">DatasetTemplate</span>

<span class="n">template</span> <span class="o">=</span> <span class="n">DatasetTemplate</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s1">&#39;id of your template&#39;</span><span class="p">)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">get_or_create_by_full_path</span><span class="p">(</span><span class="s1">&#39;your dataset path&#39;</span><span class="p">)</span>
<span class="c1"># Only field should be &quot;id&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">fields</span><span class="p">())</span>
<span class="n">file_object</span> <span class="o">=</span> <span class="n">Object</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s1">&#39;id of file uploaded to EDP&#39;</span><span class="p">)</span>
<span class="n">DatasetImport</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">dataset_id</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
    <span class="n">object_id</span><span class="o">=</span><span class="n">file_object</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
    <span class="n">target_fields</span><span class="o">=</span><span class="n">template</span><span class="o">.</span><span class="n">fields</span><span class="p">,</span>
    <span class="n">commit_mode</span><span class="o">=</span><span class="s1">&#39;append&#39;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="c1"># Wait for import to finish</span>
    <span class="n">dataset</span><span class="o">.</span><span class="n">activity</span><span class="p">(</span><span class="n">follow</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># Should now see all the non-transient fields from the template!</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">fields</span><span class="p">())</span>
</pre></div>
</div>
</section>
<section id="update-a-template">
<h2>Update a Template:<a class="headerlink" href="#update-a-template" title="Permalink to this heading">¶</a></h2>
<p>Template attributes such as the list of fields can be edited. For example, new fields can be added to an existing template. In this example, a new field called <code class="docutils literal notranslate"><span class="pre">&quot;phase_numeric&quot;</span></code> is added to the template to transform roman numerals to numbers in the phase field of the dataset.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">quartzbio</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">DatasetTemplate</span>

<span class="c1"># Retrieve a template by ID</span>
<span class="n">my_template</span> <span class="o">=</span> <span class="n">DatasetTemplate</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s1">&#39;dataset_id&#39;</span><span class="p">)</span>
<span class="c1">#Create updated list of fields as an empty list</span>
<span class="n">updated_fields</span><span class="o">=</span><span class="p">[]</span>
<span class="c1">#Get fields from my_template and add to list</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">my_template</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
    <span class="n">updated_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="c1"># Write a new field</span>
    <span class="n">phase_numeric</span><span class="o">=</span><span class="p">{</span>  <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;phase_numeric&quot;</span><span class="p">,</span>  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;phase_numeric&quot;</span><span class="p">,</span>  <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>  <span class="s2">&quot;depends_on&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;phase&quot;</span><span class="p">],</span>  <span class="s2">&quot;expression&quot;</span><span class="p">:</span> <span class="s2">&quot;record.phase.replace(&#39;III&#39;, &#39;3&#39;).replace(&#39;II&#39;, &#39;2&#39;).replace(&#39;I&#39;, &#39;1&#39;)&quot;</span><span class="p">}</span>
    <span class="c1">#Add new field to updated fields list</span>
    <span class="n">updated_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">phase_numeric</span><span class="p">)</span>
    <span class="c1">#Update template fields</span>
    <span class="n">my_template</span><span class="o">.</span><span class="n">fields</span><span class="o">=</span><span class="n">updated_fields</span>
    <span class="c1">#Save template</span>
    <span class="n">my_template</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
    <span class="c1"># Test the template by applying it to a few records</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">get_by_full_path</span><span class="p">(</span><span class="s2">&quot;vault:/my/dataset/&quot;</span><span class="p">)</span><span class="n">records</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">query</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">records</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">my_template</span><span class="o">.</span><span class="n">fields</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
        <span class="c1">#Update other attributes such as version and save</span>
        <span class="n">my_template</span><span class="o">.</span><span class="n">version</span><span class="o">=</span><span class="s1">&#39;2.00&#39;</span><span class="n">my_template</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="building-and-testing-templates-with-the-annotator">
<h2>Building and Testing Templates with the Annotator<a class="headerlink" href="#building-and-testing-templates-with-the-annotator" title="Permalink to this heading">¶</a></h2>
<p>When creating new templates it it is useful to use the <a class="reference external" href="https://quartzbio.github.io/quartzbio-python/expressions.html#annotating-records">annotator</a> to test and validate the fields and their expressions. The below snippet will use the annotator to process records in real time with the template fields.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">quartzbio</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">DatasetTemplate</span>

<span class="c1"># Load fields from a template</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">get_by_full_path</span><span class="p">(</span><span class="s1">&#39;vault:/my/dataset/&#39;</span><span class="p">)</span>
<span class="n">template</span> <span class="o">=</span> <span class="n">DatasetTemplate</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="n">template_id</span><span class="p">)</span>
<span class="c1"># Retrieve and annotate records with the dataset template fields</span>
<span class="n">records</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">query</span><span class="p">()</span>
<span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">records</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">template</span><span class="o">.</span><span class="n">fields</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
    <span class="c1"># Annotate records server side (most efficient)</span>
    <span class="n">records</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">target_fields</span><span class="o">=</span><span class="n">template</span><span class="o">.</span><span class="n">fields</span><span class="p">)</span>
    <span class="c1"># Use the Annotator class</span>
    <span class="n">ann</span> <span class="o">=</span> <span class="n">Annotator</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="n">template</span><span class="o">.</span><span class="n">fields</span><span class="p">)</span><span class="n">records</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">query</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">ann</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">records</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="api-endpoints">
<h2>API Endpoints<a class="headerlink" href="#api-endpoints" title="Permalink to this heading">¶</a></h2>
<p>Methods do not accept URL parameters or request bodies unless specified. Please note that if your EDP endpoint is sponsor-cloud.edp.aws.quartz.bio, you would use sponsor-cloud.api.edp.aws.quartz.bio. For correct work of the API, you need to change <code class="docutils literal notranslate"><span class="pre">&lt;EDP_API_HOST&gt;</span></code> to your current domain, such as my-domain.api.edp.aws.quartz.bio</p>
<section id="id1">
<h3>Dataset Templates<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>HTTP Request</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Authorization</p></th>
<th class="head"><p>Response</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>create</p></td>
<td><p>POST <a class="reference external" href="https:/">https:/</a>/&lt;EDP_API_HOST&gt;/v2/dataset_templates</p></td>
<td><p>Create a dataset template.</p></td>
<td><p>This request requires an authorized user with appropriate permissions.</p></td>
<td><p>The response contains the new DatasetTemplate resource.</p></td>
</tr>
</tbody>
</table>
<p>Request Body:</p>
<p>In the request body, provide an object with the following properties:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>string</p></td>
<td><p>A short name for the new template.</p></td>
</tr>
<tr class="row-odd"><td><p>description</p></td>
<td><p>string</p></td>
<td><p>A description for the template.</p></td>
</tr>
<tr class="row-even"><td><p>fields</p></td>
<td><p>objects</p></td>
<td><p>A list of valid dataset fields.</p></td>
</tr>
<tr class="row-odd"><td><p>version</p></td>
<td><p>string</p></td>
<td><p>A string representing a template version (no spaces).</p></td>
</tr>
<tr class="row-even"><td><p>template_type</p></td>
<td><p>string</p></td>
<td><p>The type of template: dataset, recipe or search.</p></td>
</tr>
<tr class="row-odd"><td><p>is_public</p></td>
<td><p>boolean</p></td>
<td><p>True if visible to anyone in a user’s organization (default False).</p></td>
</tr>
<tr class="row-even"><td><p>annotator_params</p></td>
<td><p>object</p></td>
<td><p>(Optional) Configuration parameters for the Annotator.</p></td>
</tr>
<tr class="row-odd"><td><p>entity_params</p></td>
<td><p>object</p></td>
<td><p>(Optional) Configuration parameters for entity detection.</p></td>
</tr>
<tr class="row-even"><td><p>reader_params</p></td>
<td><p>object</p></td>
<td><p>(Optional) Configuration parameters for readers.</p></td>
</tr>
<tr class="row-odd"><td><p>validation_params</p></td>
<td><p>object</p></td>
<td><p>(Optional) Configuration parameters for validation.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>HTTP Request</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Authorization</p></th>
<th class="head"><p>Response</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>delete</p></td>
<td><p>DELETE <a class="reference external" href="https:/">https:/</a>/&lt;EDP_API_HOST&gt;/v2/dataset_templates/{ID}</p></td>
<td><p>Delete a dataset template.</p></td>
<td><p>This request requires an authorized user with write permissions on the resource.</p></td>
<td><p>The response returns “HTTP 200 OK” when successful.</p></td>
</tr>
<tr class="row-odd"><td><p>generate</p></td>
<td><p>GET <a class="reference external" href="https:/">https:/</a>/&lt;EDP_API_HOST&gt;/v2/datasets/{DATASET_ID}/template</p></td>
<td><p>Create a dataset template from an existing dataset.</p></td>
<td><p>This request requires an authorized user with permission.</p></td>
<td><p>The response contains an unsaved DatasetTemplate object for the specified dataset.</p></td>
</tr>
<tr class="row-even"><td><p>get</p></td>
<td><p>GET <a class="reference external" href="https:/">https:/</a>/&lt;EDP_API_HOST&gt;/v2/dataset_templates/{ID}</p></td>
<td><p>Retrieve a dataset template.</p></td>
<td><p>This request requires an authorized user with permission.</p></td>
<td><p>The response contains a DatasetTemplate resource.</p></td>
</tr>
<tr class="row-odd"><td><p>list</p></td>
<td><p>GET <a class="reference external" href="https:/">https:/</a>/&lt;EDP_API_HOST&gt;/v2/dataset_templates</p></td>
<td><p>Retrieve a list of available dataset templates.</p></td>
<td><p>This request requires an authorized user with read permission.</p></td>
<td><p>The response contains a list of resources visible to the requesting user.</p></td>
</tr>
</tbody>
</table>
<p>Parameters</p>
<p>This request accepts the following parameters:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>limit</p></td>
<td><p>integer</p></td>
<td><p>The number of objects to return per page.</p></td>
</tr>
<tr class="row-odd"><td><p>offset</p></td>
<td><p>integer</p></td>
<td><p>The offset within the list of available objects.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">QuartzBio</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Authentication</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="authentication.html">Authentication</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Vaults and Files</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="exporting_data.html">Exporting Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="importing_data.html">Importing Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="import_parameters.html">Import Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="import_parameters.html#json-jsonl">JSON (JSONL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="vaults_and_objects.html">Vaults and Objects</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Datasets</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="creating_and_migrating_datasets.html">Creating and Migrating Datasets</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Dataset Templates</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#retrieving-templates">Retrieving Templates</a></li>
<li class="toctree-l2"><a class="reference internal" href="#template-fields">Template Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="#template-permissions">Template Permissions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#create-a-template">Create a Template</a></li>
<li class="toctree-l2"><a class="reference internal" href="#create-a-dataset-with-a-template">Create a Dataset with a Template</a></li>
<li class="toctree-l2"><a class="reference internal" href="#update-a-template">Update a Template:</a></li>
<li class="toctree-l2"><a class="reference internal" href="#building-and-testing-templates-with-the-annotator">Building and Testing Templates with the Annotator</a></li>
<li class="toctree-l2"><a class="reference internal" href="#api-endpoints">API Endpoints</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dataset_versioning.html">Dataset Versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="joining_and_aggregating_datasets.html">Joining and Aggregating Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="transforming_datasets.html">Transforming Datasets</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Expressions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="expressions.html">Expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="expression_functions.html">Expression Functions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Global Search</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="data_discovery.html">Data Discovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="metadata_and_global_beacons.html">Metadata and Global Beacons</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Queries and Filters</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="filters.html">Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="querying_datasets_and_files.html">Querying Datasets and Files</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Changelog</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="https://pypi.org/project/quartzbio/">Current Version: v1.2.0</a></li>
    
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="creating_and_migrating_datasets.html" title="previous chapter">Creating and Migrating Datasets</a></li>
      <li>Next: <a href="dataset_versioning.html" title="next chapter">Dataset Versioning</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025 Precision for Medicine, inc..
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.1.2</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="_sources/dataset_templates.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>